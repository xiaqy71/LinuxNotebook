# 介绍与准备

## Linux发展史

### Linux前身-Unix

#### 1968年Multics 项目

MIT、Bell 实验室、美国通用电气有限公司走到了一起，致力于开发 Multics 项目。到后期由于开发进度不是很好，MIT和 Bell 实验室相继离开这个项目的开发，最终导致项目搁浅。

#### 1970年(Unix 元年，时间戳) Unix 诞生

当时在开发Multics 项目的时候，实验室中有一个开发成员开发了一款游戏(travelspace邀游太空)，因为两个实验室相继离开项目开发，导致这名开发人员没法玩游戏，后来他提议组织人员重新在 Multics 项目之上重新的开发，也就出现了1970年的Unix。当时 Unix操作系统是使用的汇编语言(机器语言)开发的。

#### 1973年用C语言重写Unix

因为汇编语言有一个最大的局限性:对于计算机硬件过于依赖。导致移植性不好，所以后期在1973年使用了C语言对其进行重新开发。

#### 1975年 Bell 实验室允许大学使用 Unix

1975年Bell实验室允许大学使用Unix操作系统用于教学作用，而不允许用于商业用
途。

### Linux诞生

人物：Linus
Linux的开发作者，Linux之父，李纳斯·托瓦兹。

#### 1991年0.0.1版本

李纳斯当时学校使用的就是Unix操作系统，然后其对系统的底层代码进行了修改，放到了学校为学生开放的网站上，原先他把文件命名写成了Linus's Unix，后期网络管理发现之后觉得这个名字不好，自己手动的将名字改成 Linux。随后其他同学下载之后发现这个版本还是挺好用的，随后都把自己代码贡献给李纳斯。

#### 1992年0.0.2版本

#### 1994年1.0版本

#### 2003年2.6版本

上述所提及的版本号并不是分支版本，而是指Linux的内核版本。

### 开源文化

Linux是开源的操作系统。所谓开源就是指开放源代码。人物Stallman斯特曼，开源文化的倡导人。

- 1983年GNU计划
- 1985年FSF 基金会
- 1990年 Emacs、GcC(C语言的编译器)、glibc (C的函数库)
- 1991年 Stallman去找Linus，商谈让Linux 加入其开源计划(GNU计划)1992年 GNU/Linux

### Linux分支

分支:Linux分支有很多，现在比较有名的ubuntu、debian、centos (CommunityEnterprise Operating System社区企业操作系统) 、redhat等等。

### Linux系统特点

开放性(开源)、多用户、多任务、良好的用户界面、优异的性能与稳定性、**一切皆文件**。

- 多用户多任务
  - 单用户:一个用户，在登录计算机(操作系统)，只能允许同时登录一个用户;
  - 单任务:—个任务，允许用户同时进行的操作任务数量;
  - 多用户:多个用户，在登录计算机(操作系统)，允许同时登录多个用户进行操作;
  - 多任务:多个任务，允许用户同时进行多个操作任务。

Windows属于:单用户、多任务
Linux属于: 多用户、多任务

- 一切皆文件
  - 在Windows是文件的，在Linux下同样也是文件;
  - 在Windows不是文件的，在Linux下也是以文件的形式存储的。

### 终端与指令

#### 一、终端

—系列输入输出设备的总称

- 终端的打开方式:
  - 鼠标右键-打开终端
  - CTRL+ALT+T
  - 在当前终端窗口再打开—个终端:CTRL+SHIFT+T
  - 切换终端:ALT+数字
- 终端的放大与缩小:
  - 放大:CTRL+SHIFT+ '+'
  - 缩小: CTRL+ '-'

#### 二、shell

命令解释器，根据输入的命令执行相应命令
echo $SHELLI查看当前终端的命令解析器

##### shell家族

- shell
- bash
- dash

#### 三、指令

##### 1.指令标准格式

一个完整的指令的标准格式：Linux通用的格式

`command [options] parammeter1 parameter2 ...`

- 一行指令的第一个部分是指令名称
- 中括号不在实际指令中，-号后面是指令选项，如ls -a;如果使用完整全名则使用--符号，如ls--all
- parameter1 parameter2 ...为参数，如ls /dev
- 指令、选项、参数中间以空格区分，不论几个空格shell都视为一个空格
- 按下回车键后，指令立即执行，如果指令太长可以使用反斜杠再按回车键到下一行而先不执行
- --help选项:指令的求助说明，基本用法和选项参数

##### 2.路径和文件名的补齐

- 路径和文件名补齐:\[Tab\]键
- 查看历史记录:history

### 文件与目录

#### 目录结构

#### 目录与路径

##### 1.ls指令

list，列出目录及文件名

- 用法1：#ls

含义：列出当前目录下的目录及文件名

白色为普通文件，蓝色为目录，红色为压缩文件，绿色为可执行文件，浅蓝色为链接文件（背景颜色的显示和文件的权限有关）

- 用法2：#ls 路径

含义：列出指定路径下的目录及文件名

- 用法3：#ls 选项 路径

含义：在列出指定路径下的目录及文件名，并以指定的格式进行显示。
常用语法：

- #ls -l 路径
- #ls -la 路径
- #ls -lh 路径
- #ll （ls -alF的别名，alias ll）

选项解释:

- -l：list，表示以详细列表的形式进行展示
- -a：表示显示所有的文件和文件夹（包含了隐藏文件和文件夹）
- -h：以可读性较高的形式显示文档大小
- -F：在列出的文件名称后加-符号；例如可执行则加"\*"，目录则加"/"

\*\* 在Linux中隐藏文档一般都是以"."开头。

##### 2.pwd指令

print working directory，打印当前工作目录

##### 3.cd指令

change directory，切换目录

- 用法1：#cd

含义：切换到家目录（~）

- 用法2：#cd 路径
  常用语法：

- #cd -：回到上一个工作目录
- #cd ~：切换到家目录
- #cd /: 切换到根目录
  = #cd ..:切换到上一级目录

##### 4.du指令

查看目录的真实大小

- 用法：#du -sh 目录路径

选项：

- -s：summaries，只显示汇总的大小
- -h：以高可读性的形式进行显示

#### 文件与目录管理

##### 1.mkdir指令

make directory，创建目录

- 用法1：#mkdir 目录名称

含义：指定目录名称创建，支持绝对路径和相对路径，只有名称则在当前目录下创建

- 用法2：#mkdir -p 目录名称

含义：当一次性创建多层不存在的目录的时候，添加-p参数，否则会报错

- 用法3：#mkdir 路径1 路径2 路径3 ...

含义：一次性创建多个目录

##### 2.touch命令

修改文件或目录的时间属性，若文件不存在则创建

- 用法：#touch 文件路径

含义：指定文件名或路径创建文件

##### 3.cp指令

copy，复制文件或目录

- 用法：#cp 被复制的文件路径 被复制到的路径

注意：如果存在名字相同的，会覆盖同名文件

常用选项：

- -a：all，复制时保留文件属性
- -r：recursive，递归复制

复制后的文件属性会变化，如果想要把属性也复制过来加-a

复制目录，加-r或-a

##### 4.mv指令

move，移动文件与目录，或改名

- 用法：#mv 需要移动的文档路径 需要保存的位置路径

移动文件：

重命名：

##### 5.rm指令

remove，移除文件或目录

- 语法：#rm 选项 需要移除的文档路径

常用选项：

- -f：force，强制删除，不提示是否删除
- -r：recursive，递归删除，**危险**

删除一个目录的时候需要做递归删除，并且一般也不需要进行删除确认询问，所以移除目录的时候一般需要使用-rf选项

删除一个目录下有公共特性的文档，例如都以day开头。使用通配符\*，表示任意的字符，day表示以abc开头的任意文件名

#### 文件内容的查阅与统计

##### 1.cat指令

concatenate，连接文件并打印到标准输出设备上（查看文件）

- 用法1：#cat文件的路径
  常用选项：-n列出行号

- 用法2：#abc
  含义：倒序显示（应用：查看日志）

##### 2.head指令

查看一个文件的前n行，默认显示前10行

- 用法：
  - #head -number 文件路径 [n表示数字]
  - #head -n number 文件路径

n为负数？负的行数不显示

##### 3.tail指令

查看一个文件的末n行，默认显示后10行

- 用法1：

  - #tail -number 文件路径 [n表示数字]
  - #tail -n number 文件路径

- 用法2：#tail -f 文件路径

含义：持续检测文件内容，一般用于查看系统日志

##### 4.less指令

查看文件，支持翻页

- 用法：#less 文件路径

操作指令：

- 空格键：向下翻动一页
- [pagedown]：向下翻动一页
- [pageup]：向上翻动一页
- j：下一行
- k：上一行
- G：移动到最后一行
- g：移动到第一行
- /字符串：向下搜索字符串
- ?字符串：向上搜索字符串
- q：退出 less

#### 统计与查找

##### 1.wc指令

- 用法：#wc -lwc需要统计的文件路径

选项解释：- -l：表示lines，行数 - -w：表示words，单词数 依照空格来判断单词数量 - -c：表示bytes，字节数

##### 2.find指令

查找文件（其参数有55个之多）

- 用法：#find路径范围 选项 选项的值

常用选项：

- type：按文件类型搜索 （普通文件类型：f）
- name：按文件名搜索
- maxdepth：指定搜索深度
- size：按文件大小

##### 3.输出重定向

一般命令的输出都会显示在终端中，有些时候需要将一些命令的执行结果保存到文件中进行后续的分析/统计，则这时候需要使用到输出重定向技术。

- 输出重定向符号：

  - \>：覆盖输出，会覆盖原文件的内容
  - \>\>：追加输出，不会覆盖原文件内容，在原内容末尾继续添加

- 用法：#指令 \>/\>\>文件的路径

含义：指令结果保存到指定文件中。文件不存在则新建该文件

- 追加重定向：ls >> d5.txt

- 覆盖重定向：ls > d5.txt

- 合并文件：#cat 待合并的文件路径1 待合并的文件路径2 ...文件路径n > 合并之后的文件路径

```bash
cat d3.txt d4.txt > d5.txt
```

##### 4.管道

管道符：|  
管道一般可以用于“过滤”，“特殊”，“扩展处理”。管道不能单独使用，必须配合指令来一起使用，主要是辅助作用。

- 用法：指令1|指令2

含义：以管道符作为分界线，指令1的输出是指令2的输入

- 查询根目录下包含字母'b'的文件名：#ls/|grep b
  grep指令：主要用于过滤
- 以可以翻页的方式查看/etc/下的文件：`#|| /etc | less`
- 统计目录下的文件个数：`#ls /|wc -l`

#### 硬链接与软连接

##### 硬链接

###### inode和block

文件数据包含：

- 文件属性（容量、时间、权限等）
- 文件实际内容

文件系统各区块：

- inode：记录文件属性和此文件数据所在的block号码（通过inode可以找到block，索引式文件系统），一个文件占用一个inode
- block：记录实际内容，若文件太大会占用多个block
- superblock：记录文件系统整体信息，包括inode/block的总量、使用量、剩余量等（文件系统的挂载时间、最近写入数据时间等相关信息）

目录的block存什么？

- 目录下的文件名
- 文件名对应的inode（inode不记录文件名）

假设：文件夹/bin下面有两个文件：a.c和b.c，读取这两个文件内容的流程是？

###### 原理与用法

Hard Link（实体链接），文件别名。硬链接和源文件的相关信息都一样（除了文件名）

- 用法：ln 源文件 目标文件

（先 ls -il 展示源文件的inode和硬链接计数，在源文件不同的目录下创建硬链接）

第二个字段由1变成了2，这个字段的含义：有多少文件名链接到这个inode（硬链接计数）

###### 特点

- 一般不会增加inode和block，不占空间
- 对硬链接进行读写操作，操作的就是源文件
- 删除硬链接或源文件，不会影响相同inode的其他文件
- 不能跨文件系统创建硬链接
- 不能链接目录

什么时候真正删除一个文件？
删除时，硬链接计数减1，减为0时，inode节点释放

#### 软链接

##### 原理与用法

Symbolic Link（符号链接），建立一个独立文件，这个文件会让数据的读写指向它链接的文件（存它链接文件的路径）。但删除链接文件时，系统仅仅删除链接文件，而不删除源文件本身。当源文件被删除后，软链接也不能打开了。

- 用法：#ln -s 源文件 目标文件

源文件和软链接指向不同的inode

软链接移动到其他目录下，是否还能找到源文件

##### 特点

- 相当于windows的快捷方式
- 存文件路径，软连接文件很小
- 使用绝对路径
- 对软链接进行读写操作，系统会自动转成对源文件操作（删除链接文件，删除的就是链接文件，不是源文件）
- 软链接的权限是满的，真正的权限是源文件的权限
- 源文件被删除，软链接失效

#### 解压缩

##### 一、tar指令

打包和解压缩，Linux中打包文件一般是以.tar结尾的，压缩的文件一般事是以.gz结尾的，通常打包和压缩是一起进行的，打包后并压缩后的文件的后缀名一般为.atr.gz

- 常用选项
- z: 使用gzip进行解压缩
- j: 使用bzip2进行解压缩
- c: create, 创建文件
- x: extract,  解压
- v: verbose, 显示运行过程
- f: file，指定文件名
- C: 指定解压位置
- t: list, 查看打包文件中的文件名
- 用法1： `tar -zxcf 打包压缩后的文件名 要打包压缩的文件`
  - 含义: 打包并压缩文件
- 用法2: `tar -zxvf 压缩文件`
  - 含义: 解压文件到当前目录下（可以不用写z, 自动识别解压缩方式）
- 用法3: `tar -xvf 压缩文件 -C 解压路径`
- 用法4: `tar -ztvf 要查看的文件名`

##### zip 指令

- 用法1: `zip -r 压缩后的文件名 要压缩的文件`
- 用法2: `unzip 压缩文件`

##### rar 指令

下载rar 和 unrar: `sudo apt-get install rar (unrar)`

- 用法1: `rar a -r 压缩后的文件名 要压缩的文件`
- 用法2: `unrar x 压缩文件`

#### 基本操作指令

##### 查看日期与日历

1. data 指令
2. cal 指令

##### 关机与重启

1. reboot 指令
2. shutdown 指令

#### 其他指令

1. clear 指令
2. man 指令
3. service 指令

#### vim 编辑器

##### vi和vim

vi编辑器是所有Unix及Linux系统下标准的编辑器，类似于Windows系统下的记事本。很多软件默认使用vi作为他们编辑的接口。vim是进阶版的vi,vim可以视为一种程序编辑器。

复制letc/passwd文件到自己的目录下(不要直接修改letc/passwd)，后面使用passwd文件演示vim命令

下载vim: `sudo apt-get install vim`

- 用法1:`#vim文件路径`
  - 含义: 打开指定的文件
- 用法2: `#vim +数字文件的路径`
  - 含义: 打开指定的文件，并且将光标移动到指定行
- 用法3:`#vim +/关键词文件的路径`
  - 含义: 打开指定的文件，并且高亮显示关键词
- 用法4: `#vim文件路径1文件路径2文件路径3`
  - 含义: 同时打开多个文件

##### vim三种模式

vim中存在三种模式:命令模式、编辑模式(输入模式)、末行模式。

- 命令模式: 打开文件之后默认进入该模式，可以输入快捷键进行一些操作:删除、复制、粘贴、移动光标等
- 编辑模式: 可以对文件的内容进行编辑
- 末行模式: 可以在末行输入命令来对文件进行操作:搜索、替换、保存、退出、撤销、高亮等

模式切换按键说明:

- 进入编辑模式:
  - i: insert，光标处
  - l: 行首(第一个非空字符)
  - a: append，下一个字符
  - A: 行尾
  - o: open，下边插入一空行
  - O: 上边插入一空行
  - s: subst，取代当前字符
  - S: 取代当前行
- 退回命令模式:[Esc]
- 进入末行模式:
  - :
  - / 或 ?: 进入末行模式，后面接字符串进行查找
- 退出vim:
  - q: 退出
  - wq:保存并退出
  - q!:强制退出
  - x:文件没有修改时直接退出，在文件修改的情况下保存并退出（不要使用X，X是文件进行加密）

异常退出:在编辑文件之后并没有正常wq(保存退出)，而是遇到突然关闭终端或者断电的情况，则会显示下面的效果，这个情况称之为异常退出

解决办法:删除隐藏的临时文件(以.swp 结尾)

###### 命令模式

打开文件之后默认进入该模式

1.光标移动

- 光标上下左右移动: 方向键 或 kjhl
- 光标上下左右移动指定行或字符: [数字]方向键 或 [数字]kjhl
- 光标移动到行首: ^
- 光标移动到行尾: $
- 光标移动到首行: gg
- 光标移动到末行: G
- 自动格式化程序: gg=G
- 光标移动到指定行:[数字]G 或 [数字]gg
- 向上翻屏: 按键ctrl + b 或 PgUp
- 向下翻屏: 按键ctrl +f 或 PgDn

2.复制/粘贴/剪切

- 复制光标所在行: yy
- 光标所在行的下一行新开一行粘贴(paste) : p
- 以光标所在行为准(包含当前行)，向下复制指定的行数: [数字]yy
- 剪切/删除光标所在行(剪切了不粘贴就是删除)(delete) : dd
- 剪切/删除光标所在行为准(包含当前行)，向下剪切/删除指定行:[数字]dd
- 剪切/删除光标所在的当前行之后的内容: D
- 可视化操作(view) : v(可视模式)、V(可视行)、ctrl + v(可视块)，然后按下方向键来选中需要操作的区块按下y复制或按下d删除

3.撤销/恢复

- 撤销(undo) : u 或者: u(末行模式)
- 恢复(取消)之前的撤销操作: ctrl + r

###### 末行模式

1.保存与退出文件

- 保存操作(write)
- 保存::w
- 另存为: :w路径
- 退出(quit) : :q
- 保存并退出: :wq强制执行:!
- 不保存，强制退出::q!
- 文件没有修改时直接退出，在文件修改的情况下保存并退出（不要使用X，X是文件进行加密）: x

2.查找与替换

- 查找: l关键词 或 ?关键词
- 在搜索结果中切换上/下一个结果(next) : N/n
- 取消高亮(no highlight) : nohl
- 替换
- 替换光标所在行第一条原数据: s/原数据/新数据
- 替换光标所在行全部原数据: s/原数据/新数据/g
- 替换整个文件每行第一条原数据: %sl原数据/新数据
- 替换整个文件全部原数据: %s/原数据/新数据/g
- 符号含义:
  - %表示整个文件
  - g表示全局(global)

3.显示行号

- 显示行号(临时) (number): set nu
- 取消显示行号: : set nonu

4.*执行shell指令

- 执行shell指令*::![shell 指令]

5.*切换文件

- 查看当前已经打开的文件名称: files
- 切换指定文件: :open已经打开的文件名
- 切换到上一个文件(back prev) : bp
- 切换到下一个文件(back next) : bn

#### vim的配置

- 临时配置:末行模式下输入的配置
- 全局配置文件(vim自带) : /etc/vim/vimrc
- 个人配置文件（优先级更高）: ~/.vimrc

#### 用户与用户组

Linux系统是一个多用户多任务的操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员(root)申请一个账号，然后以这个账号的身份进入系统。

用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问;另一方面也可以帮助用户组织文件，并为用户提供安全性保护。

用户和用户组相关的指令都需要root权限

#### 用户标识符

每个用户都有用户ID (User ID,UID）和群组ID (Group ID，GID)，每个用户在创建时都有一个用户主组（默认和用户同名，只能有一个)，用户创建后可以添加任意个附加组。

- 存用户相关信息的文件:
  - 存储用户信息:/etc/passwd

用户名:密码:UID:GID:注释:家目录:解释器shell

每一行代表一个账号（有很多是系统账号)，UID为0是root账号，UID为1~999是保留的系统账号，1000以上一般是给一般用户的。GID是用户主组的ID

- 存储用户组信息:/etc/group
- 存储用户密码信息:/etc/shadow

#### 用户管理

##### 1. whoami指令

查看当前用户

##### 2. adduser指令

添加用户

- 用法: #adduser选项用户名
  - 常用选项:
    - gid:表示指定用户的用户主组，选项的值可以是用户组id，也可以是组名（默认创建同名的用户组）
    - uid:用户的id(用户的标识符)，系统默认会从1000之后按顺序分配uid，如果不想使用系统分配的，可以通过该选项自定义

- 验证是否成功：
  - 验证/etc/passwd的最后一行，查看是否有pointer的信息
  - 验证是否存在家目录（自动创建家目录）

##### 3. usermod指令

  修改用户

- 用法： #usermod选项 用户名
  - 常用选项：
    - g:指定用户主组
    - u:指定UID
    - I: 修改用户名
    - G:指定附加组
    - a:与-G合用（-a-G），增加附加组（保留原组）

##### 4. passwd指令

  设置/更改密码

- 用法：# passwd 用户名

  默认修改root密码

1. su指令
  切换用户
  如果用户名不指定则表示切换到root用户

- 注意事项
  - 从root往普通用户切换不需要密码，反之则需要密码
  - 切换用户之后前后的工作路径是不变的
  - 普通用户没有办法访问root用户家目录，反之则可以

1. deluser指令

删除用户

- 用法：# deluser -- remove-home 用户名
- 删除用户的同时，删除其家目录

  注意：已经登录的用户删除的时候提示删除失败， 没有登录的用户可以正常删除

### 三、用户组管理

#### 1. addgroup指令

- 用法：#addgroup 选项 用户组名

常用选项:

- gid: 设置GID， 默认从1000之后递增

#### 2. groupmod指令

用户组编辑

- 用法：#groupmod 选项 用户组名

常用选项：

-g: 设置GID
-n: 修改用户组名

#### delgroup 指令

用户组删除

- 用法:#delgroup 用户组名

### 四、文件的拥有者和所属用户组

#### 1.chown指令

changeowner，改变文件拥有者（属主）

- 用法1：chown新用户名待修改文件
- 用法2：chown-R新用户名待修改文件
  - 含义：递归修改，连同目录下所有文件都变更
- 用法3：chown新用户名：新用户组名待修改文件
  - 含义：修改拥有者和所属用户组

#### 2.hgrp指令

changegroup，改变文件所属用户组

- 用法：chgrp新用户组名待修改文件
  - 常用选项：R，递归

### 文件权限

#### 一、相关概念

Linux最优秀的地方之一就在于多人多任务环境。为了让各个使用者有较为保密的文件数据，文件的权限管理尤为重要。

- 文件的可存取身份：
  - owner：文件拥有者
  - group：文件所属用户组
  - others：其他人文件权限

- 文件权限：
  - r:read，读
    - 文件：是否能查看文件内容
    - 文件夹：是否能列出目录结构
  - w:write，写
    - 文件：是否能编辑文件内容（是否包含删除文件的权限？是否能修改文件名？）
    - 文件夹：是否能在文件夹下创建、删除、复制、移动、重命名名(能对当前文件夹重命名吗？)
  - x:eXecute，执行
    - 文件：可执行权限
    - 文件夹：能否进入该目录成为工作目录

